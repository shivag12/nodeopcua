/// <reference types="node" />
import { Certificate } from "node-opcua-crypto";
import { Params } from "./toolbox";
import { CertificateStatus, ErrorCallback, KeySize } from "./common";
export interface CertificateManagerOptions {
    keySize?: KeySize;
    location: string;
}
export declare class CertificateManager {
    private keySize;
    private location;
    private _thumbs;
    constructor(options: CertificateManagerOptions);
    readonly configFile: string;
    readonly rootDir: string;
    readonly privateKey: string;
    readonly randomFile: string;
    getCertificateStatus(certificate: Buffer): Promise<CertificateStatus>;
    getCertificateStatus(certificate: Buffer, callback: (err: Error | null, status?: CertificateStatus) => void): void;
    rejectCertificate(certificate: Certificate): Promise<void>;
    rejectCertificate(certificate: Certificate, callback: ErrorCallback): void;
    trustCertificate(certificate: Certificate): Promise<void>;
    trustCertificate(certificate: Certificate, callback: ErrorCallback): void;
    /**
     * Verify certificate validity
     * @method verifyCertificate
     * @param certificate
     * @param callback
     */
    verifyCertificate(certificate: Certificate, callback: ErrorCallback): void;
    initialize(): Promise<void>;
    initialize(callback: (err?: Error) => void): void;
    /**
     *
     * create a self-signed certificate for the CertificateManager private key
     *
     *
     * @param params
     * @param params.applicationUri   the application URI
     * @param params.altNames  array of alternate names
     * @param [params.outputFile="own/certs/self_signed_certificate.pem"]
     * @param params.subject
     * @param params.subject.commonName
     * @param params.subject.organization
     * @param params.subject.organizationUnit
     * @param params.subject.locality
     * @param params.subject.state
     * @param params.subject.country
     * @param params.validity
     * @param params.dns
     * @param params.ip
     */
    createSelfSignedCertificate(params: Params): Promise<void>;
    createSelfSignedCertificate(params: Params, callback: ErrorCallback): void;
    createCertificateRequest(params: Params, callback: (err: Error | null, certificateSigningRequestFilename?: string) => void): void;
    /**
     * @internal
     * @param certificate
     * @param callback
     * @private
     */
    _getCertificateStatus(certificate: Certificate, callback: (err: Error | null, status?: CertificateStatus) => void): void;
    private _moveCertificate;
    private _readCertificates;
}
